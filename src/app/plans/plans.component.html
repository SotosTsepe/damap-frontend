<div id="content" style="'max-width: 1440px;'">
  <h2>Plans</h2>
  <section>
    <button mat-button [routerLink]="'/dmp'" mat-raised-button color="primary">Create</button>
  </section>

  <div *ngIf="(userDmps | json) != '[]'"> <!-- fixme: proper comparison -->
    <h2>My DMPs</h2>
    <mat-form-field>
      <mat-label>Search project</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Search project" #input>
    </mat-form-field>

    <table mat-table [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8">
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef>Title</th>
        <td mat-cell *matCellDef="let element"> <h3>{{element.title}}</h3> </td>
      </ng-container>

      <ng-container matColumnDef="created">
        <th mat-header-cell *matHeaderCellDef>Created</th>
        <td mat-cell *matCellDef="let element">
          <div *ngIf="element.projects">{{element.created}}</div>
        </td>
      </ng-container>

      <ng-container matColumnDef="modified">
        <th mat-header-cell *matHeaderCellDef>Last Modified</th>
        <td mat-cell *matCellDef="let element">
          <div *ngIf="element.projects">{{element.modified}}</div>
        </td>
      </ng-container>

      <ng-container matColumnDef="edit" style="'width: 10px;'">
        <th mat-header-cell *matHeaderCellDef><span class="sr-only">Edit</span></th>
        <td mat-cell *matCellDef="let element">
          <a routerLink="/dmp/{{element.id}}">
            <button mat-button>
              <mat-icon color="primary">edit</mat-icon>
            </button>
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="history">
        <th mat-header-cell *matHeaderCellDef><span class="sr-only">History</span></th>
        <td mat-cell *matCellDef="let element">
          <a routerLink="/dmp/history/{{element.id}}">
            <button mat-button>
              <mat-icon color="accent">history</mat-icon>
            </button>
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="remove">
        <th mat-header-cell *matHeaderCellDef style="'width: 10px;'"><span class="sr-only">Delete</span></th>
        <td mat-cell *matCellDef="let element">
          <button mat-button (click)="removeDmp(element)">
            <mat-icon color="accent">delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <ng-container matColumnDef="expandedDetail">
        <td mat-cell *matCellDef="let element" [attr.colspan]="tableHeaders.length">
          <div class="element-detail"
               [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'" *ngIf="element.projects">
            <div *ngFor="let project of element.projects">
              <div class="project-overview">
                <h4> {{project.title}} </h4>
                <div> Project Duration: {{project.start | date:'d.M.y'}} - {{project.end | date:'d.M.y'}}</div>
              </div>
              <div class="project-description">
                {{element.description}}
                <span> tbd </span>
              </div>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="tableHeaders"></tr>
      <tr mat-row *matRowDef="let element; columns: tableHeaders;"
          class="example-element-row"
          [class.expanded-row]="expandedElement === element"
          (click)="expandedElement = expandedElement === element ? null : element">
      <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
    </table>
    <mat-paginator class="mat-elevation-z8" [pageSizeOptions]="[10, 20]" showFirstLastButtons></mat-paginator>

  </div>

</div>

